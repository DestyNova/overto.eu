<!doctype html><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Gunzip into dd: don't forget `-c` - Over to you</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta itemprop=name content="Gunzip into dd: don't forget `-c`"><meta itemprop=description content="Recently I was trying to copy the contents of one SD card to an identically-sized blank card, and ran into the problem of dd apparently stalling when writing to the new card, writing out zero records.
Here’s the command I used to read the first card:
sudo dd bs=4M if=/dev/sda1 status=progress|gzip > wee.img.gz Notice the use of gzip to compress the output coming out of dd. This is just to reduce the 90 GB or so of empty space on the card to (almost) nothing so my hard disk could hold the image."><meta itemprop=datePublished content="2023-12-31T03:28:37+00:00"><meta itemprop=dateModified content="2023-12-31T03:28:37+00:00"><meta itemprop=wordCount content="245"><meta itemprop=keywords content="tech,linux,"><meta property="og:title" content="Gunzip into dd: don't forget `-c`"><meta property="og:description" content="Recently I was trying to copy the contents of one SD card to an identically-sized blank card, and ran into the problem of dd apparently stalling when writing to the new card, writing out zero records.
Here’s the command I used to read the first card:
sudo dd bs=4M if=/dev/sda1 status=progress|gzip > wee.img.gz Notice the use of gzip to compress the output coming out of dd. This is just to reduce the 90 GB or so of empty space on the card to (almost) nothing so my hard disk could hold the image."><meta property="og:type" content="article"><meta property="og:url" content="https://overto.eu/posts/gunzip-into-dd/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-12-31T03:28:37+00:00"><meta property="article:modified_time" content="2023-12-31T03:28:37+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Gunzip into dd: don't forget `-c`"><meta name=twitter:description content="Recently I was trying to copy the contents of one SD card to an identically-sized blank card, and ran into the problem of dd apparently stalling when writing to the new card, writing out zero records.
Here’s the command I used to read the first card:
sudo dd bs=4M if=/dev/sda1 status=progress|gzip > wee.img.gz Notice the use of gzip to compress the output coming out of dd. This is just to reduce the 90 GB or so of empty space on the card to (almost) nothing so my hard disk could hold the image."><link rel=stylesheet type=text/css media=screen href=https://overto.eu/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://overto.eu/css/main.css><link id=dark-scheme rel=stylesheet type=text/css href=https://overto.eu/css/dark.css><script src=https://overto.eu/js/main.js></script></head><body><div class="container wrapper"><div class=header><h1 class=site-title><a href=https://overto.eu/>Over to you</a></h1><div class=site-description><nav class="nav social"><ul class=flat><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/pages/learning>Learning</a></li><li><a href=/tags/music>Music</a></li><li><a href=/pages/languages>Programming languages</a></li><li><a href=/pages/software>Software</a></li><li><a href=/pages/startups>Startups</a></li><li><a href=/tags/tech>Tech</a></li></ul></nav></div><div class=post><div class=post-header><div class=meta><div class=date><span class=day>31</span>
<span class=rest>Dec 2023</span></div></div><div class=matter><h1 class=title>Gunzip into dd: don't forget `-c`</h1></div></div><div class=paragraph><p>Recently I was trying to copy the contents of one SD card to an identically-sized blank card, and ran into the problem of <code>dd</code> apparently stalling when writing to the new card, writing out zero records.</p></div><div class=paragraph><p>Here’s the command I used to read the first card:</p></div><div class=listingblock><div class=content><pre class=highlight><code>sudo dd bs=4M if=/dev/sda1 status=progress|gzip &gt; wee.img.gz</code></pre></div></div><div class=paragraph><p>Notice the use of <code>gzip</code> to compress the output coming out of <code>dd</code>. This is just to reduce the 90 GB or so of empty space on the card to (almost) nothing so my hard disk could hold the image. It didn’t have any positive or negative impact on the speed since <code>dd</code> still had to read those blank sectors from the card, so in all it took around 90 minutes to back up the card with my laptop’s apparently slow built-in SD card reader.</p></div><div class=paragraph><p>To write out the data to a newly-inserted blank card, I did the following:</p></div><div class=listingblock><div class=content><pre class=highlight><code>gunzip wee.img.gz|sudo dd bs=4M of=/dev/sda1 status=progress oflag=direct</code></pre></div></div><div class=paragraph><p>I’d read that <code>oflag=direct</code> was required to get meaningful progress numbers, but either way nothing happened and <code>dd</code> seemed to just stall when doing this. A bit of web searching soon informed me that the <code>-c</code> option is required for <code>gunzip</code> to write the data out to stdout rather than trying to unpack the data in place (which wouldn’t fit on my hard disk anyway). With that change it’s now writing happily at a blistering 15 MB/s:</p></div><div class=listingblock><div class=content><pre class=highlight><code>gunzip -c wee.img.gz|sudo dd iflag=fullblock bs=4M of=/dev/sda1 status=progress oflag=direct</code></pre></div></div><hr class=footer-separator><div class=tags><ul class=flat><li class=tag-li><a href=/tags/tech>tech</a></li><li class=tag-li><a href=/tags/linux>linux</a></li></ul></div><div class=back><a href=https://overto.eu/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div></div><hr style="height:10px;border:0;box-shadow:0 10px 10px -10px #8c8b8b inset"><section class=section><script src=https://utteranc.es/client.js repo=DestyNova/overto.eu issue-term=pathname label=comment theme=gruvbox-dark crossorigin=anonymous async></script></section><div class="footer wrapper"><nav class=nav><div>2023</div></nav></div></body></html>